<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Create New Quiz | LMS Portal</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  padding: 40px;
  color: #333;
}

.back-button {
  position: fixed;
  top: 25px;
  left: 25px;
  background: rgba(255, 255, 255, 0.9);
  color: #333;
  padding: 10px 20px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: bold;
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
  transition: all 0.3s ease;
  z-index: 1000;
}
.back-button:hover {
  background: white;
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}

.quiz-container {
  max-width: 900px;
  margin: 0 auto;
  background: rgba(255,255,255,0.95);
  padding: 40px;
  border-radius: 15px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15);
  backdrop-filter: blur(8px);
  animation: fadeIn 0.8s ease;
}

@keyframes fadeIn {
  from { opacity:0; transform:translateY(15px); }
  to { opacity:1; transform:translateY(0); }
}

h1 { text-align:center; margin-bottom:30px; color:#333; }
label { font-weight:600; margin-top:15px; display:block; color:#333; }
input, select { width:100%; padding:12px; margin-top:8px; border:1px solid #ccc; border-radius:10px; font-size:16px; transition:0.3s; }
input:focus, select:focus { border-color:#667eea; box-shadow:0 0 8px rgba(102,126,234,0.4); outline:none; }

.question-block {
  margin-top:25px;
  border:1px solid #e1e1e1;
  border-radius:12px;
  padding:20px;
  background: rgba(245,245,245,0.9);
  box-shadow:0 8px 15px rgba(0,0,0,0.05);
}

.question-block h3 { margin-bottom:12px; color:#222; }

button {
  background:#667eea;
  color:white;
  border:none;
  padding:14px 28px;
  border-radius:10px;
  cursor:pointer;
  font-size:16px;
  font-weight:bold;
  transition: all 0.3s ease;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  margin-top:20px;
}
button:hover {
  background:#5a6de0;
  transform: translateY(-3px);
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
}
</style>
</head>
<body>
<!-- <a href="quizz.html" class="back-button">← Back</a> -->

<div class="quiz-container">
<h1>Create a New Quiz</h1>
<form id="quizForm">
  <label>Quiz Title</label>
  <input type="text" id="title" required />

  <label>Start Time</label>
  <input type="datetime-local" id="start_time" required />

  <label>End Time</label>
  <input type="datetime-local" id="end_time" required />

  <div id="questionsContainer"></div>

  <button type="button" id="addQuestionBtn">➕ Add Question</button>
  <button type="submit">✅ Create Quiz</button>
</form>
</div>

<script>
const questionsContainer = document.getElementById("questionsContainer");
const addQuestionBtn = document.getElementById("addQuestionBtn");
let questionCount = 0;

addQuestionBtn.addEventListener("click", () => {
  if(questionCount >= 10){ alert("Maximum 10 questions allowed!"); return; }
  questionCount++;
  const div = document.createElement("div");
  div.className = "question-block";
  div.innerHTML = `
    <h3>Question ${questionCount}</h3>
    <label>Question Text</label>
    <input type="text" class="question-text" required />
    <label>Option A</label><input type="text" class="optionA" required />
    <label>Option B</label><input type="text" class="optionB" required />
    <label>Option C</label><input type="text" class="optionC" required />
    <label>Option D</label><input type="text" class="optionD" required />
    <label>Correct Answer (A/B/C/D)</label>
    <select class="answer" required>
      <option value="">Select</option>
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
      <option value="D">D</option>
    </select>
  `;
  questionsContainer.appendChild(div);
});

document.getElementById("quizForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const title = document.getElementById("title").value;
  const start_time = document.getElementById("start_time").value;
  const end_time = document.getElementById("end_time").value;
  const questionBlocks = document.querySelectorAll(".question-block");
  const questions = [];
  questionBlocks.forEach(q => {
    questions.push({
      question: q.querySelector(".question-text").value,
      options:{
        A:q.querySelector(".optionA").value,
        B:q.querySelector(".optionB").value,
        C:q.querySelector(".optionC").value,
        D:q.querySelector(".optionD").value,
      },
      answer: q.querySelector(".answer").value
    });
  });
  const payload = { title, start_time, end_time, questions, created_by:"educator@example.com" };
  try {
    const res = await fetch("https://vwnzyha9dd.execute-api.us-east-1.amazonaws.com/prod/createQuiz",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(payload)
    });
    const data = await res.json();
    alert("✅ Quiz Created Successfully!");
    document.getElementById("quizForm").reset();
    questionsContainer.innerHTML="";
    questionCount=0;
  } catch(err){ alert("❌ Failed to create quiz."); console.error(err); }
});
</script>
<script src="auth-check.js"></script>
</body>
</html>

