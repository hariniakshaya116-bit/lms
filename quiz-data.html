<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Quizzes | LMS Portal</title>
<style>
* {margin:0; padding:0; box-sizing:border-box;}
body {
  font-family:"Segoe UI",Arial,sans-serif;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  min-height:100vh;
  padding:40px;
  color:#333;
}
.back-button{
  position:fixed; top:25px; left:25px; background:rgba(255,255,255,0.9); color:#333;
  padding:10px 20px; border-radius:8px; text-decoration:none; font-weight:bold;
  box-shadow:0 5px 15px rgba(0,0,0,0.15); transition:all 0.3s ease; z-index:1000;
}
.back-button:hover { background:white; transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,0.25); }

.container{
  max-width:1000px; margin:0 auto; background:rgba(255,255,255,0.95);
  padding:40px; border-radius:15px; box-shadow:0 15px 35px rgba(0,0,0,0.15);
  backdrop-filter:blur(8px); animation:fadeIn 0.8s ease;
}
@keyframes fadeIn { from{opacity:0;transform:translateY(15px);} to{opacity:1;transform:translateY(0);} }

h1{text-align:center;margin-bottom:30px;color:#333;}
table{width:100%;border-collapse:collapse;border-radius:10px;overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,0.1);}
th, td{padding:12px 15px; text-align:left; border:none;}
th{background-color:#667eea;color:#fff;font-weight:600;}
tr:nth-child(even){background-color:rgba(102,126,234,0.1);}
tr:hover{background-color:rgba(102,126,234,0.2); transition: background 0.3s ease;}
button.view-btn {
  padding:6px 12px;
  border:none;
  border-radius:6px;
  background-color:#007bff;
  color:white;
  cursor:pointer;
}
button.view-btn:hover { background-color:#0056b3; }

#quizDetails{
  margin-top:30px;
  background:#f9f9f9;
  padding:20px;
  border-radius:12px;
  display:none;
}
.question { margin-bottom:15px; }
.question h3 { margin-bottom:8px; }
label { display:block; margin-left:10px; }
</style>
</head>
<body>
<!-- <a href="quizz.html" class="back-button">‚Üê Back</a> -->

<div class="container">
<h1>All Quizzes</h1>
<table id="quizzesTable">
<thead>
<tr><th>Quiz ID</th><th>Title</th><th>Created At</th><th>Scheduled From</th><th>Scheduled To</th><th>Action</th></tr>
</thead>
<tbody></tbody>
</table>

<div id="quizDetails">
  <h2>Quiz Details</h2>
  <div id="quizTitle"></div>
  <div id="questionsContainer"></div>
</div>
</div>

<script>
const API_BASE="https://vwnzyha9dd.execute-api.us-east-1.amazonaws.com/prod";

// Load all quizzes
async function loadQuizzes(){
  try{
    const res=await fetch(`${API_BASE}/getAllQuizzes`);
    const data=await res.json();
    const tbody=document.querySelector("#quizzesTable tbody");
    tbody.innerHTML="";
    data.quizzes.forEach(q=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${q.quizId}</td>
        <td>${q.title}</td>
        <td>${q.created_at||"-"}</td>
        <td>${q.start_time||"-"}</td>
        <td>${q.end_time||"-"}</td>
        <td><button class="view-btn" onclick="viewQuiz('${q.quizId}')">View</button></td>
      `;
      tbody.appendChild(tr);
    });
  }catch(err){console.error(err); alert("Failed to load quizzes");}
}

// Fetch and display quiz questions/options
async function viewQuiz(quizId){
  try{
    const res=await fetch(`${API_BASE}/getQuiz?quizId=${quizId}`);
    const data=await res.json();
    if(data.error){ alert(data.error); return; }

    document.getElementById("quizTitle").innerHTML=`<strong>${data.title}</strong>`;
    const container=document.getElementById("questionsContainer");
    container.innerHTML="";

    data.questions.forEach((q, idx)=>{
      const div=document.createElement("div");
      div.classList.add("question");
      div.innerHTML=`<h3>${idx+1}. ${q.question}</h3>`;
      if(Array.isArray(q.options)){
        q.options.forEach(opt=>{
          const label=document.createElement("label");
          label.textContent=opt;
          div.appendChild(label);
        });
      }
      container.appendChild(div);
    });

    document.getElementById("quizDetails").style.display="block";
  }catch(err){console.error(err); alert("Failed to load quiz details");}
}

// Load quizzes on page load
loadQuizzes();
</script>
<script src="auth-check.js"></script>
</body>
</html>

